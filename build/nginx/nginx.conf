server {
  listen          8080;
  server_name     _;

  root        /app;
  client_max_body_size 500M;

  # Логи
  access_log /var/log/nginx/access.log;
  error_log /var/log/nginx/error.log;

  proxy_hide_header   X-Frame-Options;
  add_header          X-Frame-Options "";
  
  location /static/ {
      alias /app/static/;
      expires 30d;
      add_header Cache-Control "public, max-age=2592000";
      access_log off;
  }

  location /media/ {
      alias /app/media/;
      expires 30d;
      add_header Cache-Control "public, max-age=2592000";
      access_log off;
  }

  location / {
    proxy_pass http://127.0.0.1:8002;
    proxy_set_header Range "";
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header REMOTE_ADDR $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_set_header Host $host;
    
    # Timeout settings
    proxy_connect_timeout 3600s;
    proxy_read_timeout 3600s;
    proxy_send_timeout 3600s;
    
    # Additional settings
    proxy_buffering off;
    proxy_request_buffering off;
    proxy_http_version 1.1;
    proxy_set_header Connection "";
    
    # Keepalive settings
    proxy_ignore_client_abort on;
  }

  location = /50x.html {
    root   /usr/share/nginx/html;
  }
}

# upstream web_map {
#     server optimove:8000;
# }

# server {

#     listen 80;

#     location / {
#         proxy_pass http://web_map;
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#         proxy_set_header X-Forwarded-Proto $scheme;
#         proxy_set_header Origin $http_origin;
#         proxy_redirect off;
#     }

#     location /static/ {
#         alias /home/static/;
#     }

#     location /media/ {
#         alias /home/media/;
#     }
# }